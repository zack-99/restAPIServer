<!DOCTYPE html>
<html class="min-vh-100">

<head>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
	<title>API</title>
	<script>
		function loading() {
			document.querySelector("#loading").style.opacity = 1;
			document.querySelector("#loading").style.pointerEvents = 'initial';
		}
	</script>
	<style>
		#loading svg {
			animation-name: loading;
  			animation-duration: 2s;
			animation-timing-function: linear;
			animation-fill-mode: forwards;
			animation-iteration-count: infinite;
			animation-play-state: running;
		}

		@keyframes loading {
			from {transform: rotate(0deg)}
			to {transform: rotate(360deg)}
		}
	</style>
</head>

<body class="d-flex justify-content-center align-content-center min-vh-100 flex-wrap column-gap-5 row-gap-5">
	<div id="loading" style="background-color: rgba(0,0,0,.5); height: 100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 1; transition: 250ms; pointer-events: none; opacity: 0;" class="d-flex justify-content-center align-items-center">
		<svg width="50" height="50" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M12.5498 2.16296V6.16296" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M12.5498 18.163V22.163" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M5.47949 5.09296L8.30949 7.92296" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M16.79 16.403L19.62 19.233" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M2.5498 12.163H6.5498" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M18.5498 12.163H22.5498" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M5.47949 19.233L8.30949 16.403" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M16.79 7.92296L19.62 5.09296" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
		</svg>			
	</div>


	<h2 class="w-100 text-center my-3">API disponibili</h2>

	<div class="card">
		<h5 class="card-header">Prescrizioni</h5>
		<div class="card-body">
			<table>
				<tr>
					<td>Info su tutte le prescrizioni di un reparto</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3 pb-4">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="prescriptions?department=Cardiologia" />
							<input class="btn btn-primary" type="submit" value="Cardiologia" onclick="loading()" />
						</form>
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="prescriptions?department=error" />
							<input class="btn btn-primary" type="submit" value="Error" onclick="loading()" />
						</form>
					</td>
				</tr>
				<tr>
					<td>Info su tutte le prescrizioni di un paziente specifico di un reparto</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3 pb-4">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="prescription?department=Cardiologia&patient=patient1" />
							<input class="btn btn-primary" type="submit" value="Cardiologia, Patient1" onclick="loading()" />
						</form>
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="prescription?department=error&patient=patient1" />
							<input class="btn btn-primary" type="submit" value="Error, Patient1" onclick="loading()" />
						</form>
					</td>
				</tr>
				<tr>
					<td>Info su tutte le mie prescrizioni</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="prescription/me" />
							<input class="btn btn-primary" type="submit" value="Me" onclick="loading()" />
						</form>
					</td>
				</tr>

			</table>
		</div>
	</div>

	<div class="card">
		<h5 class="card-header">Pazienti</h5>
		<div class="card-body">
			<table>
				<tr>
					<td>Info su tutti i pazienti di un reparto</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3 pb-4">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="patients?department=Cardiologia" />
							<input class="btn btn-primary" type="submit" value="Cardiologia" onclick="loading()" />
						</form>
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="patients?department=error" />
							<input class="btn btn-primary" type="submit" value="Error" onclick="loading()" />
						</form>
					</td>
				</tr>
				<tr>
					<td>Info su un paziente specifico di un reparto specifico</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3 pb-4">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="patient?department=Cardiologia&patient=patient1"/>
							<input class="btn btn-primary" type="submit" value="Cardiologia, Patient1" onclick="loading()" />
						</form>
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="patient?department=error&patient=patient1"/>
							<input class="btn btn-primary" type="submit" value="Error, Patient1" onclick="loading()" />
						</form>
					</td>
				</tr>
				<tr>
					<td>Info su di me</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="patient/me" />
							<input class="btn btn-primary" type="submit" value="Me" onclick="loading()" />
						</form>
					</td>
				</tr>
			</table>
		</div>
	</div>

	<div class="card">
		<h5 class="card-header">Dottori</h5>
		<div class="card-body">
			<table>
				<tr>
					<td>Info su tutti i dottori</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3 pb-4">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="doctors" />
							<input class="btn btn-primary" type="submit" value="All" onclick="loading()" />
						</form>
					</td>
				</tr>
				<tr>
					<td>Info su tutti i dottori di un reparto</td>
				</tr>
				<tr>
					<td class="d-flex column-gap-3">
						<form action="/result_api" method="get">
							<input type="hidden" name="end_point" value="doctors/department?department=departmentname"/>
							<input class="btn btn-primary" type="submit" value="Departmentname" onclick="loading()" />
						</form>
					</td>
				</tr>
			</table>
		</div>
	</div>

	<div class="card w-75">
		<h5 class="card-header">API result</h5>
		<div class="card-body">
			{{result}}
		</div>
	</div>
	<!--
	<br>
	<b>Ovviamente ci sono anche gli endpoint per inserire nuove prescrizioni ad un paziente, nuovi pazienti, ... (sono ancora da implementare, ma ci vuole un secondo)</b>
	<br>
	<b>Il mio dubbio su queste è che in realtà non saprei cosa far vedere come risultato della chiamata per l'esame</b>
	<br>
	<p>I dati restituiti qui sotto non sono generati automaticamente.</p>
	<p>Per testare le api direttamente da swagger bisogna modificare nel FASTAPI_server il metodo check_valid_token: decommentare il return None dopo "if token_auth is None"</p>
	<h2>API result:</h2>
	{{result}}
	<!--<table style="width:100%">
	  <tr>
	    <th>Username</th>
	    <th>Email</th> 
	  </tr>
	  {% for user in users %}
	  <tr>
	  	<td>{{ user['username'] }}</td>
	  	<td>{{ user['email'] }}</td>
	  </tr>
	  {% endfor %}
	</table>-->
<!--
	<h2>Dubbi e cose da risolvere:</h2>
	<ul>
		<li>Come gestiamo l'uso delle API da Swagger? Dobbiamo creare dei nuovi end_point solo per swagger per ottenere un token, altrimenti non possiamo testarle direttamente da lì</li>
	</ul>
-->
</body>

</html>